<!DOCTYPE html>
<html  lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>登录</title>
	<link rel="stylesheet" href="../static/css/login.css">
	<script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>
<div id="login">
	<form method="post" id="form">
		<p id="p">您好!<br />
		欢迎使用互联网零售可视化系统</p><br />
		<div id="usertext">用户名<br /></div>
		<input id="username" name="name" type="text" required="required" autocomplete="off" maxlength="10"></input>
		<br /><br />
		<div id="passwordtext">密码<br /></div>
		<input id="password" name="password" type="password" required="required" autocomplete="off" maxlength="16" style="letter-spacing:3px"></input>
		<br /><br />
		<label>用户名或密码错误！</label>
		<button id="button" type="submit">登录</button>
		<a id="href" href="/register">注册</a>
	</form>
</div>

<script>
	$.fn.serializeObject=function(){  
	    var hasOwnProperty=Object.prototype.hasOwnProperty;  
	    return this.serializeArray().reduce(function(data,pair){  
	        if(!hasOwnProperty.call(data,pair.name)){  
	            data[pair.name]=pair.value;  
	        }  
	        return data;  
	    },{});  
	}; 
	$('#form').on('submit', function(e) {
		e.preventDefault();
		var data = $('#form').serializeObject();
		$.ajax({
			url: '/login',
			type: 'post',
			data: JSON.stringify(data),
	   		headers: {'Content-Type': 'application/json;charset=utf-8'}, 
 			dataType: 'json',
			success: function(res) {
				if(res.code==400){
					$("label").css("color","red");
				}
				if(res.code == 200) {
					if (res.userinfo.job == "管理员") {
						window.location.href = "/getUserInfo";
					} else {
						window.location.href="/page/jump?page=false.html";
					}
				}
			}
		});
	})
	
// 	当鼠标聚焦输入框时，更改错误提示颜色
	$("input").focus(function(){
		$("label").css("color", "white");
	})
		
</script>
</body>
</html>