<!DOCTYPE html>
<html  lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>互联网零售可视化系统</title>
	<link rel="stylesheet" href="../static/css/login.css">
<!--	<script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>-->
	<script th:src="@{/static/js/jquery.min.js}"></script>
</head>
<body>
<div id="login">
	<form method="post" id="form">
		<p id="p">您好!<br />
		欢迎使用互联网零售可视化系统</p><br />
		<div id="usertext">用户名<br /></div>
		<input id="username" name="username" type="text" required="required" autocomplete="off" maxlength="10"></input>
		<br /><br />
		<div id="passwordtext">密码<br /></div>
		<input id="password" name="password" type="password" required="required" autocomplete="off" maxlength="16" style="letter-spacing:3px"></input>
		<br /><br />
		<label>用户名或密码错误！</label>
		<button id="button" type="submit">登录</button>
		<a id="href" href="/GoRegister">注册</a>
	</form>
</div>

<script>
	// 将表单内容封装成json对象
	$.fn.serializeObject=function(){
	    var hasOwnProperty=Object.prototype.hasOwnProperty;  
	    return this.serializeArray().reduce(function(data,pair){  
	        if(!hasOwnProperty.call(data,pair.name)){  
	            data[pair.name]=pair.value;  
	        }  
	        return data;  
	    },{});  
	}; 
	$('#form').on('submit', function(e) {
		e.preventDefault();
		$("input").blur();			/*使input失去焦点，方便当用户使用Enter登录时，错误信息的展示*/
		var data = $('#form').serializeObject();
		$.ajax({
			url: '/login',
			type: 'post',
			data: JSON.stringify(data),
	   		headers: {'Content-Type': 'application/json;charset=utf-8'}, 
 			dataType: 'json',
			success: function(res) {
				if(res.code==400){
					$("label").css("color","red");		/* 当登录失败时，显示错误提示信息 */
				}else {
					window.location.href = "/getUserInfo";
				}
			}
		});
	})

// 	当鼠标聚焦输入框时，隐藏错误信提示息
	$("input").focus(function(){
		$("label").css("color", "white");
	})
		
</script>
</body>
</html>